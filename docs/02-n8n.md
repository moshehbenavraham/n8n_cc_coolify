# n8n Workflow Automation

WSL2 Ubuntu | Docker Compose | ngrok

---

## Overview

- **Image**: `ghcr.io/moshehbenavraham/n8n:latest`
- **Deployment Path**: `$N8N_DEPLOYMENT_PATH` (see .env)
- **Mode**: Queue mode with workers

## Access

```
URL: $N8N_URL (ngrok tunnel)
Port: 5678
```

## Container Architecture

```
n8n              - Main n8n instance
n8n-worker-1/2/3 - Worker instances (3x)
runner-worker-1/2/3 - Runner instances (3x)
postgres         - n8n PostgreSQL database
redis            - Queue management
```

## n8n Database Credentials

```
Host: postgres (internal)
Port: $N8N_DB_PORT
Database: $N8N_DB_NAME
Username: $N8N_DB_USERNAME
Password: $N8N_DB_PASSWORD
```

> Credentials stored in `.env` file

## Critical Configuration

```
N8N_ENCRYPTION_KEY=$N8N_ENCRYPTION_KEY
```

> Critical secrets stored in `.env` file

## Queue Configuration (Redis)

```
QUEUE_BULL_REDIS_HOST=redis
QUEUE_BULL_REDIS_PORT=6379
QUEUE_BULL_REDIS_TIMEOUT_THRESHOLD=60000
QUEUE_WORKER_LOCK_DURATION=60000
```

## Management Commands

```bash
# Source environment variables first
source .env
cd $N8N_DEPLOYMENT_PATH

# View n8n main logs
docker compose logs -f n8n

# View worker logs
docker compose logs -f n8n-worker-1

# Restart n8n (main only)
docker compose restart n8n

# Restart all n8n containers
docker compose restart

# Access n8n database
docker compose exec postgres psql -U $N8N_DB_USERNAME -d n8n

# List n8n database tables
docker compose exec postgres psql -U $N8N_DB_USERNAME -d n8n -c "\dt"

# Check n8n execution count
docker compose exec postgres psql -U $N8N_DB_USERNAME -d n8n -c "SELECT COUNT(*) FROM execution_entity;"
```

## n8n Database Tables (Key Tables)

```
workflow_entity          - Workflow definitions
execution_entity         - Execution records
execution_data           - Execution payloads
credentials_entity       - Encrypted credentials
user                     - User accounts
webhook_entity           - Webhook endpoints
variables                - Environment variables
settings                 - n8n settings
```

## Data Volumes

```
n8n-data      - n8n user data (/home/node/.n8n)
postgres-data - PostgreSQL data
redis-data    - Redis data
```

---

*Documentation generated: 2026-01-27*
